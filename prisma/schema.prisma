generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Users{
  id Int @id @default(autoincrement())
  name String @db.VarChar(50)
  email String @unique
  password String @db.VarChar(255)
  folders Folders[]
}

model Folders{
  id Int @id @default(autoincrement())
  folder_name String @db.VarChar(255)
  created_at DateTime @default(now())
  user Users @relation(fields: [user_id], references: [id])
  user_id Int
  files Files[]

  parent_id Int? 
  parent Folders? @relation("FolderHierarchy", fields: [parent_id], references: [id])
  children Folders[] @relation("FolderHierarchy")

}

model Files{
  id Int @id @default(autoincrement())
  originalname String @db.VarChar(255)
  filename String @db.VarChar(255)
  path String @db.VarChar(255)
  size Int 
  created_at DateTime @default(now())
  folders Folders? @relation(fields: [folder_id], references: [id])
  folder_id Int? // nullable if the file is not part of any folder. else set to folder_id.
  

  // parent_id Int? @unique
  // parent Files? @relation("FileHierarchy", fields: [parent_id] )
}

//parent_id cant be @uniqeu because if it does then a folder can contain 
//only 1 subfolder. 